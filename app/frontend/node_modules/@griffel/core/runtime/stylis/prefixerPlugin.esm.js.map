{"version":3,"file":"prefixerPlugin.esm.js","sources":["../../../../../packages/core/src/runtime/stylis/prefixerPlugin.ts"],"sourcesContent":["/* eslint-disable no-fallthrough */\nimport {\n  hash,\n  charat,\n  strlen,\n  indexof,\n  replace,\n  match,\n  MS,\n  MOZ,\n  WEBKIT,\n  copy,\n  serialize,\n  DECLARATION,\n  RULESET,\n  combine,\n} from 'stylis';\nimport type { Element, Middleware } from 'stylis';\n\nexport function prefix(value: string, length: number, children?: Element[]): string {\n  switch (hash(value, length)) {\n    // color-adjust\n    case 5103:\n      return WEBKIT + 'print-' + value + value;\n    //   backface-visibility, column, box-decoration-break\n    case 3191:\n    case 6645:\n    case 3005:\n    // mask, mask-image, mask-(mode|clip|size), mask-(repeat|origin), mask-position, mask-composite\n    case 6391:\n    case 5879:\n    case 5623:\n    case 6135:\n    case 4599:\n    case 4855:\n      return WEBKIT + value + value;\n    // background-clip: text\n    case 4215:\n      switch (charat(value, length + 1)) {\n        case 116:\n          return WEBKIT + value + value;\n      }\n      break;\n    // tab-size\n    case 4789:\n      return MOZ + value + value;\n    // appearance, user-select, hyphens\n    case 5349:\n    case 4246:\n    case 6968:\n      return WEBKIT + value + MOZ + value + MS + value + value;\n    // cursor\n    // @ts-expect-error fall through is intentional here\n    case 6187:\n      if (!match(value, /grab/)) {\n        return (\n          replace(replace(replace(value, /(zoom-|grab)/, WEBKIT + '$1'), /(image-set)/, WEBKIT + '$1'), value, '') +\n          value\n        );\n      }\n    // background, background-image\n    case 5495:\n    case 3959:\n      // eslint-disable-next-line no-useless-concat\n      return replace(value, /(image-set\\([^]*)/, WEBKIT + '$1' + '$`$1');\n    // (margin|padding)-inline-(start|end)\n    case 4095:\n    case 3583:\n    case 4068:\n    case 2532:\n      return replace(value, /(.+)-inline(.+)/, WEBKIT + '$1$2') + value;\n    // (min|max)?(width|height|inline-size|block-size)\n    case 8116:\n    case 7059:\n    case 5753:\n    case 5535:\n    case 5445:\n    case 5701:\n    case 4933:\n    case 4677:\n    case 5533:\n    case 5789:\n    case 5021:\n    case 4765:\n      // stretch fill-available\n      if (strlen(value) - 1 - length > 6)\n        switch (charat(value, length + 1)) {\n          // (f)ill-available\n          // @ts-expect-error fall through is intentional here\n          case 102:\n            if (charat(value, length + 3) === 108) {\n              return (\n                replace(\n                  value,\n                  /(.+:)(.+)-([^]+)/,\n                  // eslint-disable-next-line no-useless-concat, eqeqeq\n                  '$1' + WEBKIT + '$2-$3' + '$1' + MOZ + (charat(value, length + 3) == 108 ? '$3' : '$2-$3'),\n                ) + value\n              );\n            }\n          // (s)tretch\n          case 115:\n            return ~indexof(value, 'stretch')\n              ? prefix(replace(value, 'stretch', 'fill-available'), length, children) + value\n              : value;\n        }\n      break;\n  }\n\n  return value;\n}\n\n/**\n * @param {object} element\n * @param {number} index\n * @param {object[]} children\n * @param {function} callback\n */\nexport function prefixerPlugin(\n  element: Element,\n  index: number,\n  children: Element[],\n  callback: Middleware,\n): string | undefined {\n  if (element.length > -1)\n    if (!element.return)\n      switch (element.type) {\n        case DECLARATION:\n          element.return = prefix(element.value, element.length, children);\n          return;\n        case RULESET:\n          if (element.length)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return combine(element.props, function (value) {\n              switch (match(value, /(::plac\\w+|:read-\\w+)/)) {\n                // :read-(only|write)\n                case ':read-only':\n                case ':read-write':\n                  return serialize(\n                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                    // @ts-ignore\n                    [copy(element, { props: [replace(value, /:(read-\\w+)/, ':' + MOZ + '$1')] })],\n                    callback,\n                  );\n                // :placeholder\n                case '::placeholder':\n                  return serialize(\n                    [\n                      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                      // @ts-ignore\n                      copy(element, { props: [replace(value, /:(plac\\w+)/, ':' + WEBKIT + 'input-$1')] }),\n                      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                      // @ts-ignore\n                      copy(element, { props: [replace(value, /:(plac\\w+)/, ':' + MOZ + '$1')] }),\n                      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                      // @ts-ignore\n                      copy(element, { props: [replace(value, /:(plac\\w+)/, MS + 'input-$1')] }),\n                    ],\n                    callback,\n                  );\n              }\n\n              return '';\n            });\n      }\n\n  return undefined;\n}\n"],"names":["prefix","value","length","children","hash","WEBKIT","charat","MOZ","MS","match","replace","strlen","indexof","prefixerPlugin","element","index","callback","return","type","DECLARATION","RULESET","combine","props","serialize","copy","undefined"],"mappings":"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"}