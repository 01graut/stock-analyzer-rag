{"version":3,"sources":["useVirtualizerScrollViewDynamic.js"],"sourcesContent":["import * as React from 'react';\nimport { slot, useMergedRefs } from '@fluentui/react-utilities';\nimport { useVirtualizer_unstable } from '../Virtualizer/useVirtualizer';\nimport { useDynamicVirtualizerMeasure } from '../../Hooks';\nimport { useVirtualizerContextState_unstable, scrollToItemDynamic } from '../../Utilities';\nimport { useImperativeHandle } from 'react';\nexport function useVirtualizerScrollViewDynamic_unstable(props) {\n    const contextState = useVirtualizerContextState_unstable(props.virtualizerContext);\n    const { imperativeRef, axis = 'vertical', reversed, imperativeVirtualizerRef } = props;\n    var _props_axis, _contextState_contextIndex;\n    const { virtualizerLength, bufferItems, bufferSize, scrollRef } = useDynamicVirtualizerMeasure({\n        defaultItemSize: props.itemSize,\n        direction: (_props_axis = props.axis) !== null && _props_axis !== void 0 ? _props_axis : 'vertical',\n        getItemSize: props.getItemSize,\n        currentIndex: (_contextState_contextIndex = contextState === null || contextState === void 0 ? void 0 : contextState.contextIndex) !== null && _contextState_contextIndex !== void 0 ? _contextState_contextIndex : 0,\n        numItems: props.numItems\n    });\n    // Store the virtualizer length as a ref for imperative ref access\n    const virtualizerLengthRef = React.useRef(virtualizerLength);\n    if (virtualizerLengthRef.current !== virtualizerLength) {\n        virtualizerLengthRef.current = virtualizerLength;\n    }\n    const scrollViewRef = useMergedRefs(props.scrollViewRef, scrollRef);\n    const scrollCallbackRef = React.useRef(null);\n    const _imperativeVirtualizerRef = useMergedRefs(React.useRef(null), imperativeVirtualizerRef);\n    useImperativeHandle(imperativeRef, ()=>{\n        var _imperativeVirtualizerRef_current;\n        return {\n            scrollTo (index, behavior = 'auto', callback) {\n                scrollCallbackRef.current = callback !== null && callback !== void 0 ? callback : null;\n                if (_imperativeVirtualizerRef.current) {\n                    var _imperativeVirtualizerRef_current;\n                    const progressiveSizes = _imperativeVirtualizerRef.current.progressiveSizes.current;\n                    const totalSize = progressiveSizes && (progressiveSizes === null || progressiveSizes === void 0 ? void 0 : progressiveSizes.length) > 0 ? progressiveSizes[Math.max(progressiveSizes.length - 1, 0)] : 0;\n                    _imperativeVirtualizerRef.current.setFlaggedIndex(index);\n                    scrollToItemDynamic({\n                        index,\n                        itemSizes: (_imperativeVirtualizerRef_current = _imperativeVirtualizerRef.current) === null || _imperativeVirtualizerRef_current === void 0 ? void 0 : _imperativeVirtualizerRef_current.nodeSizes,\n                        totalSize,\n                        scrollViewRef,\n                        axis,\n                        reversed,\n                        behavior\n                    });\n                }\n            },\n            currentIndex: (_imperativeVirtualizerRef_current = _imperativeVirtualizerRef.current) === null || _imperativeVirtualizerRef_current === void 0 ? void 0 : _imperativeVirtualizerRef_current.currentIndex,\n            virtualizerLength: virtualizerLengthRef\n        };\n    }, [\n        axis,\n        scrollViewRef,\n        reversed,\n        _imperativeVirtualizerRef\n    ]);\n    const handleRenderedIndex = (index)=>{\n        if (scrollCallbackRef.current) {\n            scrollCallbackRef.current(index);\n        }\n    };\n    const virtualizerState = useVirtualizer_unstable({\n        ...props,\n        virtualizerLength,\n        bufferItems,\n        bufferSize,\n        scrollViewRef,\n        virtualizerContext: contextState,\n        imperativeVirtualizerRef: _imperativeVirtualizerRef,\n        onRenderedFlaggedIndex: handleRenderedIndex\n    });\n    return {\n        ...virtualizerState,\n        components: {\n            ...virtualizerState.components,\n            container: 'div'\n        },\n        container: slot.always(props.container, {\n            defaultProps: {\n                ref: scrollViewRef\n            },\n            elementType: 'div'\n        })\n    };\n}\n"],"names":["useVirtualizerScrollViewDynamic_unstable","props","contextState","useVirtualizerContextState_unstable","virtualizerContext","imperativeRef","axis","reversed","imperativeVirtualizerRef","_props_axis","_contextState_contextIndex","virtualizerLength","bufferItems","bufferSize","scrollRef","useDynamicVirtualizerMeasure","defaultItemSize","itemSize","direction","getItemSize","currentIndex","contextIndex","numItems","virtualizerLengthRef","React","useRef","current","scrollViewRef","useMergedRefs","scrollCallbackRef","_imperativeVirtualizerRef","useImperativeHandle","_imperativeVirtualizerRef_current","scrollTo","index","behavior","callback","progressiveSizes","totalSize","length","Math","max","setFlaggedIndex","scrollToItemDynamic","itemSizes","nodeSizes","handleRenderedIndex","virtualizerState","useVirtualizer_unstable","onRenderedFlaggedIndex","components","container","slot","always","defaultProps","ref","elementType"],"mappings":"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"}