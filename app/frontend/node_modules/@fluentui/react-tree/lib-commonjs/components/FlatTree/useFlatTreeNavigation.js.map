{"version":3,"sources":["useFlatTreeNavigation.js"],"sourcesContent":["import { useFluent_unstable } from '@fluentui/react-shared-contexts';\nimport { useEventCallback } from '@fluentui/react-utilities';\nimport { nextTypeAheadElement } from '../../utils/nextTypeAheadElement';\nimport { treeDataTypes } from '../../utils/tokens';\nimport { treeItemFilter } from '../../utils/treeItemFilter';\nimport { useRovingTabIndex } from '../../hooks/useRovingTabIndexes';\nimport { dataTreeItemValueAttrName } from '../../utils/getTreeItemValueFromElement';\nexport function useFlatTreeNavigation() {\n    const { targetDocument } = useFluent_unstable();\n    const { rove, initialize } = useRovingTabIndex(treeItemFilter);\n    function getNextElement(data, walker) {\n        if (!targetDocument) {\n            return null;\n        }\n        switch(data.type){\n            case treeDataTypes.Click:\n                return data.target;\n            case treeDataTypes.TypeAhead:\n                walker.currentElement = data.target;\n                return nextTypeAheadElement(walker, data.event.key);\n            case treeDataTypes.ArrowLeft:\n                {\n                    const nextElement = parentElement(data.parentValue, walker);\n                    if (!nextElement && process.env.NODE_ENV !== 'production') {\n                        // eslint-disable-next-line no-console\n                        console.warn(`@fluentui/react-tree [useFlatTreeNavigation]:\n\\'ArrowLeft\\' navigation was not possible.\nNo parent element found for the current element:`, data.target);\n                    }\n                    return nextElement;\n                }\n            case treeDataTypes.ArrowRight:\n                {\n                    walker.currentElement = data.target;\n                    const nextElement = firstChild(data.target, walker);\n                    if (!nextElement && process.env.NODE_ENV !== 'production') {\n                        const ariaLevel = Number(data.target.getAttribute('aria-level'));\n                        // eslint-disable-next-line no-console\n                        console.warn(`@fluentui/react-tree [useFlatTreeNavigation]:\n\\'ArrowRight\\' navigation was not possible.\nNo element with \"aria-posinset=1\" and \"aria-level=${ariaLevel + 1}\"\nwas found after the current element!`, data.target);\n                    }\n                    return nextElement;\n                }\n            case treeDataTypes.End:\n                walker.currentElement = walker.root;\n                return walker.lastChild();\n            case treeDataTypes.Home:\n                walker.currentElement = walker.root;\n                return walker.firstChild();\n            case treeDataTypes.ArrowDown:\n                walker.currentElement = data.target;\n                return walker.nextElement();\n            case treeDataTypes.ArrowUp:\n                walker.currentElement = data.target;\n                return walker.previousElement();\n        }\n    }\n    const navigate = useEventCallback((data, walker)=>{\n        const nextElement = getNextElement(data, walker);\n        if (nextElement) {\n            rove(nextElement);\n        }\n    });\n    return {\n        navigate,\n        initialize\n    };\n}\nfunction firstChild(target, treeWalker) {\n    const nextElement = treeWalker.nextElement();\n    if (!nextElement) {\n        return null;\n    }\n    const nextElementAriaPosInSet = nextElement.getAttribute('aria-posinset');\n    const nextElementAriaLevel = nextElement.getAttribute('aria-level');\n    const targetAriaLevel = target.getAttribute('aria-level');\n    if (nextElementAriaPosInSet === '1' && Number(nextElementAriaLevel) === Number(targetAriaLevel) + 1) {\n        return nextElement;\n    }\n    return null;\n}\nfunction parentElement(parentValue, treeWalker) {\n    if (parentValue === undefined) {\n        return null;\n    }\n    return treeWalker.root.querySelector(`[${dataTreeItemValueAttrName}=\"${parentValue}\"]`);\n}\n"],"names":["useFlatTreeNavigation","targetDocument","useFluent_unstable","rove","initialize","useRovingTabIndex","treeItemFilter","getNextElement","data","walker","type","treeDataTypes","Click","target","TypeAhead","currentElement","nextTypeAheadElement","event","key","ArrowLeft","nextElement","parentElement","parentValue","process","env","NODE_ENV","console","warn","ArrowRight","firstChild","ariaLevel","Number","getAttribute","End","root","lastChild","Home","ArrowDown","ArrowUp","previousElement","navigate","useEventCallback","treeWalker","nextElementAriaPosInSet","nextElementAriaLevel","targetAriaLevel","undefined","querySelector","dataTreeItemValueAttrName"],"mappings":"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"}