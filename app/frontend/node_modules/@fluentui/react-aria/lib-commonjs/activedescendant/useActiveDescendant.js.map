{"version":3,"sources":["useActiveDescendant.js"],"sourcesContent":["import * as React from 'react';\nimport { useOptionWalker } from './useOptionWalker';\nimport { ACTIVEDESCENDANT_ATTRIBUTE } from './constants';\nexport function useActiveDescendant(options) {\n    const { imperativeRef, matchOption } = options;\n    const activeParentRef = React.useRef(null);\n    const { listboxRef, optionWalker } = useOptionWalker({\n        matchOption\n    });\n    const getActiveDescendant = ()=>{\n        var _listboxRef_current;\n        return (_listboxRef_current = listboxRef.current) === null || _listboxRef_current === void 0 ? void 0 : _listboxRef_current.querySelector(`[${ACTIVEDESCENDANT_ATTRIBUTE}]`);\n    };\n    const setActiveDescendant = (nextActive)=>{\n        const active = getActiveDescendant();\n        if (active) {\n            active.removeAttribute(ACTIVEDESCENDANT_ATTRIBUTE);\n        }\n        if (nextActive) {\n            var _activeParentRef_current;\n            nextActive.setAttribute(ACTIVEDESCENDANT_ATTRIBUTE, '');\n            (_activeParentRef_current = activeParentRef.current) === null || _activeParentRef_current === void 0 ? void 0 : _activeParentRef_current.setAttribute('aria-activedescendant', nextActive.id);\n        } else {\n            var _activeParentRef_current1;\n            (_activeParentRef_current1 = activeParentRef.current) === null || _activeParentRef_current1 === void 0 ? void 0 : _activeParentRef_current1.removeAttribute('aria-activedescendant');\n        }\n    };\n    React.useImperativeHandle(imperativeRef, ()=>({\n            first: ()=>{\n                if (!listboxRef.current || !activeParentRef.current) {\n                    return;\n                }\n                const first = optionWalker.first();\n                if (first) {\n                    setActiveDescendant(first);\n                }\n            },\n            next: ()=>{\n                if (!listboxRef.current || !activeParentRef.current) {\n                    return;\n                }\n                const active = getActiveDescendant();\n                if (!active) {\n                    return;\n                }\n                optionWalker.setCurrent(active);\n                const next = optionWalker.next();\n                if (next) {\n                    setActiveDescendant(next);\n                }\n            },\n            prev: ()=>{\n                if (!listboxRef.current || !activeParentRef.current) {\n                    return;\n                }\n                const active = getActiveDescendant();\n                if (!active) {\n                    return;\n                }\n                optionWalker.setCurrent(active);\n                const next = optionWalker.prev();\n                if (next && next !== listboxRef.current) {\n                    setActiveDescendant(next);\n                }\n            },\n            blur: ()=>{\n                if (!listboxRef.current || !activeParentRef.current) {\n                    return;\n                }\n                setActiveDescendant(undefined);\n            },\n            active: ()=>{\n                if (listboxRef.current) {\n                    var _getActiveDescendant;\n                    return (_getActiveDescendant = getActiveDescendant()) === null || _getActiveDescendant === void 0 ? void 0 : _getActiveDescendant.id;\n                }\n            },\n            focus: (id)=>{\n                if (!listboxRef.current) {\n                    return;\n                }\n                optionWalker.setCurrent(listboxRef.current);\n                let cur = optionWalker.next();\n                while(cur && cur.id !== id){\n                    cur = optionWalker.next();\n                }\n                if (cur) {\n                    setActiveDescendant(cur);\n                }\n            }\n        }));\n    return {\n        listboxRef,\n        activeParentRef\n    };\n}\n"],"names":["useActiveDescendant","options","imperativeRef","matchOption","activeParentRef","React","useRef","listboxRef","optionWalker","useOptionWalker","getActiveDescendant","_listboxRef_current","current","querySelector","ACTIVEDESCENDANT_ATTRIBUTE","setActiveDescendant","nextActive","active","removeAttribute","_activeParentRef_current","setAttribute","id","_activeParentRef_current1","useImperativeHandle","first","next","setCurrent","prev","blur","undefined","_getActiveDescendant","focus","cur"],"mappings":"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"}