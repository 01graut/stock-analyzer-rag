import{r as s,bD as _e,bE as t}from"./vendor-9f580cb9.js";import{R as F,G as xe,V as Q,u as p,S as fe,Q as Te,E as be,A as ye,a as d,b as Ae,c as Pe,d as je,e as we,r as m,i as L,T as Ve,g as D,f as Oe,h as Re}from"./index-1cc27a6f.js";import{o as Ie,m as Ne,D as Ge,T as M,n as Ee,l as S}from"./fluentui-react-eb607e90.js";import"./fluentui-icons-13e46eed.js";const Ue="_askContainer_1vvbs_1",Be="_askTopSection_1vvbs_8",Fe="_askBottomSection_1vvbs_15",Qe="_askTitle_1vvbs_25",Le="_askQuestionInput_1vvbs_39",De="_askAnswerContainer_1vvbs_46",Me="_askAnalysisPanel_1vvbs_53",qe="_askSettingsSeparator_1vvbs_58",He="_settingsButton_1vvbs_62",n={askContainer:Ue,askTopSection:Be,askBottomSection:Fe,askTitle:Qe,askQuestionInput:Le,askAnswerContainer:De,askAnalysisPanel:Me,askSettingsSeparator:qe,settingsButton:He};function ze(){const[T,g]=s.useState(!1),[v,q]=s.useState(""),[b,Je]=s.useState(""),[y,Ke]=s.useState(""),[H,A]=s.useState(F.Hybrid),[P,z]=s.useState(3),[k,j]=s.useState(!0),[w,J]=s.useState(!1),[c,K]=s.useState(!1),[V,W]=s.useState(xe.TextAndImages),[O,X]=s.useState(""),[Y,Z]=s.useState(""),[$,ee]=s.useState([Q.Embedding,Q.ImageEmbedding]),[R,te]=s.useState(!1),[I,se]=s.useState(!1),[N,ae]=s.useState(!1),[ne,oe]=s.useState(!1),[ie,re]=s.useState(!1),h=s.useRef(""),[C,G]=s.useState(!1),[l,E]=s.useState(),[o,ce]=s.useState(),[U,B]=s.useState(),[u,r]=s.useState(void 0),i=p?_e().instance:void 0,le=async()=>{const e=i?await D(i):void 0;Oe(e).then(a=>{ae(a.showGPT4VOptions),j(a.showSemanticRankerOption),oe(a.showSemanticRankerOption),re(a.showVectorOption),a.showVectorOption||A(F.Text)})};s.useEffect(()=>{le()},[]);const _=async e=>{h.current=e,l&&E(void 0),G(!0),B(void 0),r(void 0);const a=i?await D(i):void 0;try{const f={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:v.length===0?void 0:v,prompt_template_prefix:b.length===0?void 0:b,prompt_template_suffix:y.length===0?void 0:y,exclude_category:O.length===0?void 0:O,top:P,retrieval_mode:H,semantic_ranker:k,semantic_captions:w,use_oid_security_filter:R,use_groups_security_filter:I,vector_fields:$,use_gpt4v:c,gpt4v_input:V}},session_state:o?o.choices[0].session_state:null},Ce=await Re(f,a);ce(Ce)}catch(f){E(f)}finally{G(!1)}},ue=(e,a)=>{q(a||"")},pe=(e,a)=>{z(parseInt(a||"3"))},de=(e,a)=>{j(!!a)},me=(e,a)=>{J(!!a)},Se=(e,a)=>{X(a||"")},ge=e=>{_(e),Z(e)},ve=e=>{U===e&&u===d.CitationTab?r(void 0):(B(e),r(d.CitationTab))},x=e=>{r(u===e?void 0:e)},ke=(e,a)=>{te(!!a)},he=(e,a)=>{se(!!a)};return t.jsxs("div",{className:n.askContainer,children:[t.jsxs("div",{className:n.askTopSection,children:[t.jsx(fe,{className:n.settingsButton,onClick:()=>g(!T)}),t.jsx("h1",{className:n.askTitle,children:"Ask your data"}),t.jsx("div",{className:n.askQuestionInput,children:t.jsx(Te,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:C,initQuestion:Y,onSend:e=>_(e)})})]}),t.jsxs("div",{className:n.askBottomSection,children:[C&&t.jsx(Ie,{label:"Generating answer"}),!h.current&&t.jsx(be,{onExampleClicked:ge,useGPT4V:c}),!C&&o&&!l&&t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(ye,{answer:o,isStreaming:!1,onCitationClicked:e=>ve(e),onThoughtProcessClicked:()=>x(d.ThoughtProcessTab),onSupportingContentClicked:()=>x(d.SupportingContentTab)})}),l?t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(Ae,{error:l.toString(),onRetry:()=>_(h.current)})}):null,u&&o&&t.jsx(Pe,{className:n.askAnalysisPanel,activeCitation:U,onActiveTabChanged:e=>x(e),citationHeight:"600px",answer:o,activeTab:u})]}),t.jsxs(Ne,{headerText:"Configure answer generation",isOpen:T,isBlocking:!1,onDismiss:()=>g(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(Ge,{onClick:()=>g(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(M,{className:n.askSettingsSeparator,defaultValue:v,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:ue}),t.jsx(Ee,{className:n.askSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:P.toString(),onChange:pe}),t.jsx(M,{className:n.askSettingsSeparator,label:"Exclude category",onChange:Se}),ne&&t.jsx(S,{className:n.askSettingsSeparator,checked:k,label:"Use semantic ranker for retrieval",onChange:de}),t.jsx(S,{className:n.askSettingsSeparator,checked:w,label:"Use query-contextual summaries instead of whole documents",onChange:me,disabled:!k}),N&&t.jsx(je,{gpt4vInputs:V,isUseGPT4V:c,updateUseGPT4V:e=>{K(e)},updateGPT4VInputs:e=>W(e)}),ie&&t.jsx(we,{showImageOptions:c&&N,updateVectorFields:e=>ee(e),updateRetrievalMode:e=>A(e)}),p&&t.jsx(S,{className:n.askSettingsSeparator,checked:R||m,label:"Use oid security filter",disabled:!L(i)||m,onChange:ke}),p&&t.jsx(S,{className:n.askSettingsSeparator,checked:I||m,label:"Use groups security filter",disabled:!L(i)||m,onChange:he}),p&&t.jsx(Ve,{})]})]})}ze.displayName="Ask";export{ze as Component};
//# sourceMappingURL=Ask-f3e41960.js.map
